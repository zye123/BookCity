"use strict";define(["jquery","base64","template","bscroll"],function(i,o,a,t){var e=window.localStorage,c=e.getItem("fontSize")||18,n=e.getItem("bgcolor")||"#f7eee5",s=e.getItem("fontcolors")||"#333";i(".book-cont").css("fontSize",c),i(".book-cont").css("background",n),i(".book-cont>.list>li").css("color",s);var r=e.getItem("chapter_id")||1,u=null;function l(){e.setItem("chapter_id",r),i.ajax({url:"/book/reader-list?article="+r,dataType:"json",success:function(o){var s,t,l,e=o.jsonp;s=r,t=e,(l=document.createElement("script")).src=t,window.duokan_fiction_chapter=function(o){var t=i.base64().decode(o),e=JSON.parse(t),c=i(".tpl").html();i(".book-cont").empty(),a(c,e,".book-cont");var n=u.length;i(".menu-list").html(s+"/"+n),document.head.removeChild(l)},document.head.appendChild(l)}})}function d(o){var t=parseInt(i(".book-cont>.list>li").css("font-size"));i(".book-cont>.list>li").css("font-size",t+o),e.setItem("fontSize",t+o)}i.ajax({url:"/book/menu",dataType:"json",async:!1,success:function(o){u=o.item.toc}}),l(),i(".book-cont").on("click",function(){i(".head").toggleClass("show"),i("footer").toggleClass("show")}),i(".font").on("click",function(){i(".font-dialog").toggleClass("active")}),i(".mulu").on("click",function(){i(".menu-dialog").addClass("shows");var o=i(".tels").html();a(o,{list:u},".mains")}),i(".back").on("click",function(){i(".menu-dialog").removeClass("shows"),i(".mains").empty()}),i(".menu-dialog").on("click","li",function(){r=i(this).data("id"),e.setItem("chapter_id",r),l(),i(".menu-dialog").removeClass("shows")}),i(".prev").on("click",function(){if(--r<1)return!1;l()}),i(".next").on("click",function(){if(++r>u.length)return!1;l()}),i(".col").on("click","li",function(){var o=i(this).css("background");i(".book-cont").css("background",o),i(this).addClass("border_color").siblings().removeClass("border_color"),i(".five").hasClass("border_color")&&i(".book-cont>.list>li").css("color","#eee"),e.setItem("bgcolor",o),e.setItem("fontcolors","#eee")}),i(".font-small").on("click",function(){d(-2)}),i(".font-large").on("click",function(){d(2)}),i(".day").on("click",function(){"白天"===i(this).html()?(i(this).html("夜晚"),i(".book-cont").css("background","#283548"),i(".book-cont>.list>li").css("color","#eee")):"夜晚"===i(this).html()&&(i(this).html("白天"),i(".book-cont").css("background","#f7eee5"),i(".book-cont>.list>li").css("color","#333"))})});